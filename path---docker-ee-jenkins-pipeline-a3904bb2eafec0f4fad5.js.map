{"version":3,"sources":["webpack:///path---docker-ee-jenkins-pipeline-a3904bb2eafec0f4fad5.js","webpack:///./.cache/json/docker-ee-jenkins-pipeline.json"],"names":["webpackJsonp","333","module","exports","data","markdownRemark","html","frontmatter","title","date","path","tags","excerpt","pathContext","prev","next"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,gBAAkBC,KAAA,4rPAAusPC,aAAuBC,MAAA,kEAAAC,KAAA,iBAAAC,KAAA,8BAAAC,MAAA,mEAAAC,QAAA,4CAAuQC,aAAgBC,KAAA,KAAAC,KAAA","file":"path---docker-ee-jenkins-pipeline-a3904bb2eafec0f4fad5.js","sourcesContent":["webpackJsonp([275133165580617],{\n\n/***/ 333:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h2>Overview</h2>\\n<p>This post will describe a technique to achieve Continuous Integration and Deployment in Docker Enterprise Edition using Jenkins Pipelines.</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-9160a.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 51.46484375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACiklEQVQoz11SXUhUQRSeO6NZ68yaSEkPBf6iq65mZVtbu/eura74k5VQtrv3rj+bRUWPkmYkREr50ksPWfYgBRFI0EPiQ20YpZlpapmVImJEiUIlRPRwOrMqmAOX4Z5z5jvf951DRKZKRLpTIXhiSS4xx+9LFFv3Z/NMdaOMbfB6SAyzKWQxGK6Rhw7r0WS2OoV8q0kjUGeSMWW6iihjBiE8TwsXiQxnJYJMcJcbuLsQ8H8Rv0ay5tAR3auMGpOsLwAs5Af6wjenvDPqZS6yvWKpCIHO4uMhYdWA73F18V3aHYzNcqv6kudq1xJIJA2zGDV6EPAHfauHaL+/k/X67iLgb4z/QXZlK2B2lA14P4pRbPGr2fCdWocoL5e52yjzFp07A8im+z/KC7XJ2OQp5r/inUJ4jtokCkpAJDvqCTRuon3+A+yZN5XAuTiR4IgXFuerqLYKkBKVceM5e1y5xbzZrkbbXZZoLT9x2YbLbLwO6JB+SgK2ipJSwEEUo8E7UEozdmtF4DpZzELeFjYYgIhuH5iOFF5ZZt6EdlzF+zoOMp18qT7MJk4CHfA3E56l6mZbkZR1f+0AyHzNcWUmKGXOm0oLfqLPE+tPF9tlClYP6rX/ARuuBfQxIFeGo6x+LB5E0BaR5twrUh0Wnq2eNx319NBe3wfyqzY/jmTlRTw89gQfLdBB/RL5XmPBRjYcyAU6HZRyPytTVXzJ/O2aQLB2s9UNwuEBXuABc24RiCTHzLq2QzkrTJRPgVK05C8bCQIbqAY6dUKy+ogedijvjYyl/ctUwwuL0mORqQ89vYlrcw8bNPDdriSZi7p4kEY1lLEw6GRgG65NA3rcSd/oNxDQh5Ijw7kxg/4DJCHefo1vLb0AAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"DevOps Process\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-fb8a0.png\\\"\\n        srcset=\\\"/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-1a291.png 148w,\\n/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-2bc4a.png 295w,\\n/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-fb8a0.png 590w,\\n/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-526de.png 885w,\\n/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-9160a.png 1024w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h2>TL;DR</h2>\\n<ol>\\n<li>Create a <strong>jenkins</strong> user in Docker Trusted Registry (DTR)</li>\\n<li>Create an application repository in DTR</li>\\n<li>Deploy a Docker Swarm Stack</li>\\n<li>Add a Jenkinsfile using Jenkins Pipelines to your application repository</li>\\n<li>Configure Jenkins DTR credentials</li>\\n<li>Commit code to application, build and deploy with Jenkins</li>\\n</ol>\\n<h2>Detail</h2>\\n<p>There's several ways to achieve CI and/or CD, often a key deciding factor is your application or business's governance policies.</p>\\n<p>For example can you use a CI/CD service or do you need to host your own.</p>\\n<p>For this post the CI/CD senario is that you cannot use an external service and the CaaS platform will be <a href=\\\"https://www.docker.com/enterprise-edition\\\">Docker Enterprise Edition</a>.</p>\\n<p>There is essentially two parts: 1) Server configurations and 2) Application specific Jenkins pipeline scripting.</p>\\n<p>We have another reposistory that details the step by step setup for the server configurations which I'll link to <a href=\\\"https://github.com/viseo-asia/docker-enterprise-edition-demo\\\">here</a></p>\\n<p>Once your server side is setup, we just need to drop in a Jenkinsfile in each application (or microservice) that we want to deploy.</p>\\n<p>Here's an exmaple that deploys a nodejs app.</p>\\n<p>At the root of your application repo add a <a href=\\\"https://github.com/viseo-asia/blockchain-civic-demo/blob/master/Jenkinsfile\\\">Jenkinsfile</a> like the one below.</p>\\n<p>Then you just need to create a new job in Jenkins and point it to your Jenkinsfile in your git repo.</p>\\n<p>This pipeline will:</p>\\n<ol>\\n<li>Download the application code</li>\\n<li>Install dependencies</li>\\n<li>Execute unit tests and generate test coverage reports</li>\\n<li>Do code analysis and enforce quality rules like minimum percentage of test coverage</li>\\n<li>Build the docker image and tag it with the git commit id</li>\\n<li>Push the image to your local DTR</li>\\n<li>Deploy the image into your Docker swarm (Docker EE)</li>\\n</ol>\\n<p>If you have any questions or issues that aren't resolved by the documentation we've written please contact us.</p>\\n<pre class=\\\"prettyprint\\\">pipeline {\\n    agent any\\n    \\n    environment {\\n        // NODE_ENV is dev for testing first, will prune dev dependencies before deploy.\\n        NODE_ENV = 'development'\\n    }\\n    \\n    stages {\\n\\n        stage('Preparation') { \\n            steps {\\n                git branch: 'master', url: 'https://github.com/viseo-asia/blockchain-civic-demo.git'\\n                script {\\n                    // sh 'printenv'\\n                    sh 'git rev-parse HEAD > .git/commit-id'\\n                }\\n            }\\n        }\\n        \\n        stage('Test') {\\n            steps {\\n                withDockerContainer(image: 'node:8.9.4-alpine') {\\n                    sh 'yarn install'\\n                    // sh 'printenv'\\n                    script {\\n                        commit_id = readFile('.git/commit-id')\\n                    }\\n                    echo \\\"COMMIT ID: ${commit_id}\\\"\\n                    sh 'npm run ci-test-coverage'\\n                    sh 'npm run ci-test-report'\\n                }\\n                script {\\n                    scannerHome = tool 'sonarqube';\\n                }\\n                withSonarQubeEnv('sonarqube') {\\n                    script {\\n                        sh \\\"${scannerHome}/bin/sonar-scanner\\\"\\n                    }\\n                }\\n            }\\n        }\\n        \\n        stage(\\\"Quality Gate\\\") {\\n            steps {\\n                script {\\n                    qg = waitForQualityGate() // Reuse taskId previously collected by withSonarQubeEnv\\n                    if (qg.status != 'OK') {\\n                       error \\\"Pipeline aborted due to quality gate failure: ${qg.status}\\\"\\n                    }\\n                }\\n            }\\n        }\\n\\n        stage('Build') {\\n            steps {\\n                echo \\\"Git commit ID: ${commit_id}\\\"\\n                script {\\n                    // the ${commit_id} tag seems to chop off anything trailing, so we build and tag seperately\\n                    sh \\\"docker build -t viseo/civic-app .\\\"\\n                    sh \\\"docker tag viseo/civic-app local.dtr/viseo/civic-app:latest\\\"\\n                    sh \\\"docker tag viseo/civic-app local.dtr/viseo/civic-app:${commit_id}\\\"\\n\\n                }\\n            }\\n        }\\n\\n        stage('Push') {\\n            steps {\\n                withDockerRegistry(url: 'https://local.dtr', credentialsId: 'dtr-credentials') {\\n                    // latest tag is not auto, so need to push twice - each layer is uploaded only once though (no double upload)\\n                    sh \\\"docker push local.dtr/viseo/civic-app:latest\\\"\\n                    sh \\\"docker push local.dtr/viseo/civic-app:${commit_id}\\\"\\n                }\\n            }\\n        }\\n\\n        stage('Deploy') {\\n            steps {\\n                script {\\n                    sh \\\"docker service update civic_web --detach=true --image local.dtr/viseo/civic-app:latest\\\"\\n                }\\n            }\\n        }\\n\\n    }\\n}</pre>\",\"frontmatter\":{\"title\":\"Docker Enterprise Edition Continuous Integration and Deployment\",\"date\":\"March 07, 2018\",\"path\":\"/docker-ee-jenkins-pipeline\",\"tags\":[\"jenkins\",\"docker\",\"continuous integration\",\"continuous delivery\"],\"excerpt\":\"CI/CD technique using Jenkins Pipeline\"}}},\"pathContext\":{\"prev\":null,\"next\":null}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---docker-ee-jenkins-pipeline-a3904bb2eafec0f4fad5.js","module.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h2>Overview</h2>\\n<p>This post will describe a technique to achieve Continuous Integration and Deployment in Docker Enterprise Edition using Jenkins Pipelines.</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-9160a.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 51.46484375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACiklEQVQoz11SXUhUQRSeO6NZ68yaSEkPBf6iq65mZVtbu/eura74k5VQtrv3rj+bRUWPkmYkREr50ksPWfYgBRFI0EPiQ20YpZlpapmVImJEiUIlRPRwOrMqmAOX4Z5z5jvf951DRKZKRLpTIXhiSS4xx+9LFFv3Z/NMdaOMbfB6SAyzKWQxGK6Rhw7r0WS2OoV8q0kjUGeSMWW6iihjBiE8TwsXiQxnJYJMcJcbuLsQ8H8Rv0ay5tAR3auMGpOsLwAs5Af6wjenvDPqZS6yvWKpCIHO4uMhYdWA73F18V3aHYzNcqv6kudq1xJIJA2zGDV6EPAHfauHaL+/k/X67iLgb4z/QXZlK2B2lA14P4pRbPGr2fCdWocoL5e52yjzFp07A8im+z/KC7XJ2OQp5r/inUJ4jtokCkpAJDvqCTRuon3+A+yZN5XAuTiR4IgXFuerqLYKkBKVceM5e1y5xbzZrkbbXZZoLT9x2YbLbLwO6JB+SgK2ipJSwEEUo8E7UEozdmtF4DpZzELeFjYYgIhuH5iOFF5ZZt6EdlzF+zoOMp18qT7MJk4CHfA3E56l6mZbkZR1f+0AyHzNcWUmKGXOm0oLfqLPE+tPF9tlClYP6rX/ARuuBfQxIFeGo6x+LB5E0BaR5twrUh0Wnq2eNx319NBe3wfyqzY/jmTlRTw89gQfLdBB/RL5XmPBRjYcyAU6HZRyPytTVXzJ/O2aQLB2s9UNwuEBXuABc24RiCTHzLq2QzkrTJRPgVK05C8bCQIbqAY6dUKy+ogedijvjYyl/ctUwwuL0mORqQ89vYlrcw8bNPDdriSZi7p4kEY1lLEw6GRgG65NA3rcSd/oNxDQh5Ijw7kxg/4DJCHefo1vLb0AAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"DevOps Process\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-fb8a0.png\\\"\\n        srcset=\\\"/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-1a291.png 148w,\\n/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-2bc4a.png 295w,\\n/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-fb8a0.png 590w,\\n/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-526de.png 885w,\\n/static/devops-process-1024x527-e86968505197fcadcb0d3aa8a6479bf1-9160a.png 1024w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h2>TL;DR</h2>\\n<ol>\\n<li>Create a <strong>jenkins</strong> user in Docker Trusted Registry (DTR)</li>\\n<li>Create an application repository in DTR</li>\\n<li>Deploy a Docker Swarm Stack</li>\\n<li>Add a Jenkinsfile using Jenkins Pipelines to your application repository</li>\\n<li>Configure Jenkins DTR credentials</li>\\n<li>Commit code to application, build and deploy with Jenkins</li>\\n</ol>\\n<h2>Detail</h2>\\n<p>There's several ways to achieve CI and/or CD, often a key deciding factor is your application or business's governance policies.</p>\\n<p>For example can you use a CI/CD service or do you need to host your own.</p>\\n<p>For this post the CI/CD senario is that you cannot use an external service and the CaaS platform will be <a href=\\\"https://www.docker.com/enterprise-edition\\\">Docker Enterprise Edition</a>.</p>\\n<p>There is essentially two parts: 1) Server configurations and 2) Application specific Jenkins pipeline scripting.</p>\\n<p>We have another reposistory that details the step by step setup for the server configurations which I'll link to <a href=\\\"https://github.com/viseo-asia/docker-enterprise-edition-demo\\\">here</a></p>\\n<p>Once your server side is setup, we just need to drop in a Jenkinsfile in each application (or microservice) that we want to deploy.</p>\\n<p>Here's an exmaple that deploys a nodejs app.</p>\\n<p>At the root of your application repo add a <a href=\\\"https://github.com/viseo-asia/blockchain-civic-demo/blob/master/Jenkinsfile\\\">Jenkinsfile</a> like the one below.</p>\\n<p>Then you just need to create a new job in Jenkins and point it to your Jenkinsfile in your git repo.</p>\\n<p>This pipeline will:</p>\\n<ol>\\n<li>Download the application code</li>\\n<li>Install dependencies</li>\\n<li>Execute unit tests and generate test coverage reports</li>\\n<li>Do code analysis and enforce quality rules like minimum percentage of test coverage</li>\\n<li>Build the docker image and tag it with the git commit id</li>\\n<li>Push the image to your local DTR</li>\\n<li>Deploy the image into your Docker swarm (Docker EE)</li>\\n</ol>\\n<p>If you have any questions or issues that aren't resolved by the documentation we've written please contact us.</p>\\n<pre class=\\\"prettyprint\\\">pipeline {\\n    agent any\\n    \\n    environment {\\n        // NODE_ENV is dev for testing first, will prune dev dependencies before deploy.\\n        NODE_ENV = 'development'\\n    }\\n    \\n    stages {\\n\\n        stage('Preparation') { \\n            steps {\\n                git branch: 'master', url: 'https://github.com/viseo-asia/blockchain-civic-demo.git'\\n                script {\\n                    // sh 'printenv'\\n                    sh 'git rev-parse HEAD > .git/commit-id'\\n                }\\n            }\\n        }\\n        \\n        stage('Test') {\\n            steps {\\n                withDockerContainer(image: 'node:8.9.4-alpine') {\\n                    sh 'yarn install'\\n                    // sh 'printenv'\\n                    script {\\n                        commit_id = readFile('.git/commit-id')\\n                    }\\n                    echo \\\"COMMIT ID: ${commit_id}\\\"\\n                    sh 'npm run ci-test-coverage'\\n                    sh 'npm run ci-test-report'\\n                }\\n                script {\\n                    scannerHome = tool 'sonarqube';\\n                }\\n                withSonarQubeEnv('sonarqube') {\\n                    script {\\n                        sh \\\"${scannerHome}/bin/sonar-scanner\\\"\\n                    }\\n                }\\n            }\\n        }\\n        \\n        stage(\\\"Quality Gate\\\") {\\n            steps {\\n                script {\\n                    qg = waitForQualityGate() // Reuse taskId previously collected by withSonarQubeEnv\\n                    if (qg.status != 'OK') {\\n                       error \\\"Pipeline aborted due to quality gate failure: ${qg.status}\\\"\\n                    }\\n                }\\n            }\\n        }\\n\\n        stage('Build') {\\n            steps {\\n                echo \\\"Git commit ID: ${commit_id}\\\"\\n                script {\\n                    // the ${commit_id} tag seems to chop off anything trailing, so we build and tag seperately\\n                    sh \\\"docker build -t viseo/civic-app .\\\"\\n                    sh \\\"docker tag viseo/civic-app local.dtr/viseo/civic-app:latest\\\"\\n                    sh \\\"docker tag viseo/civic-app local.dtr/viseo/civic-app:${commit_id}\\\"\\n\\n                }\\n            }\\n        }\\n\\n        stage('Push') {\\n            steps {\\n                withDockerRegistry(url: 'https://local.dtr', credentialsId: 'dtr-credentials') {\\n                    // latest tag is not auto, so need to push twice - each layer is uploaded only once though (no double upload)\\n                    sh \\\"docker push local.dtr/viseo/civic-app:latest\\\"\\n                    sh \\\"docker push local.dtr/viseo/civic-app:${commit_id}\\\"\\n                }\\n            }\\n        }\\n\\n        stage('Deploy') {\\n            steps {\\n                script {\\n                    sh \\\"docker service update civic_web --detach=true --image local.dtr/viseo/civic-app:latest\\\"\\n                }\\n            }\\n        }\\n\\n    }\\n}</pre>\",\"frontmatter\":{\"title\":\"Docker Enterprise Edition Continuous Integration and Deployment\",\"date\":\"March 07, 2018\",\"path\":\"/docker-ee-jenkins-pipeline\",\"tags\":[\"jenkins\",\"docker\",\"continuous integration\",\"continuous delivery\"],\"excerpt\":\"CI/CD technique using Jenkins Pipeline\"}}},\"pathContext\":{\"prev\":null,\"next\":null}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/docker-ee-jenkins-pipeline.json\n// module id = 333\n// module chunks = 275133165580617"],"sourceRoot":""}